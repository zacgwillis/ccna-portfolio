# Symmetric VLAN Hopping Lab

## Objective
Generate ARP broadcasts into undesired VLANs due to a native VLAN trunk mismatch

## Topology

## Initial Setup / Secure Baseline
* Assign appropriate IP addresses for end-users in their respective VLAN
* Create VLANs 10 & 20 on both switches w/ their respective names
* Configure appropriate access ports for both SW1 & SW2, then configure a dot1q trunk between them

## Misconfiguration Introduced
* On SW1, configure the native VLAN as VLAN 10
* On SW2, configure the native VLAN as VLAN 20  

## Procedure / Demonstration
From PC1, ping any nonexistent IP - this will trigger an ARP broadcast. Since SW1 has a native VLAN of 10, the ARP broadcast generated by PC1's ping, will cross the trunk, untagged, w/ no additional VLAN header   

SW2 receives this untagged frame, assumes the frame is meant for its own configured native VLAN (VLAN 20 in this case) and will forward that frame into VLAN 20 (VLAN Hopping). This also works in reverse by intitiating a ping from PC2

### Evidence of Leakage
Expected / Baseline ARP Broadcast
One screenshot here of the expected, baseline ARP Broadcast (on the PC1-SW1 link)

VLAN Hopping / ARP Broadcast Leakage
Another screenshot here of SW2-PC2 Wireshark capture

## Verification & Evidence
`show interfaces [e0/1] switchport`  
`show interfaces trunk`

## Mitigation / Best Practices
* Match native VLANs on both ends of the trunk  
* Use an unused VLAN as native on all trunks  
* Avoid VLAN 1 entirely for native or data  

## Notes
* Symmetric hopping is easier to illustrate bidirectional leakage using existing PCs  
* Asymmetric mismatches are more common & stealthier - detected mainly via CDP logs/CLI, not obvious user impact
